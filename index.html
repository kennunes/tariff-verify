import React, { useState, useEffect, useMemo, useRef } from 'react';
import { 
  Upload, 
  Zap, 
  BarChart3, 
  TrendingUp, 
  PieChart, 
  CheckCircle2, 
  PhoneCall, 
  ChevronRight,
  Info,
  ArrowRightLeft,
  Calendar,
  DollarSign,
  AlertCircle,
  Loader2,
  X,
  Calculator,
  Layers,
  ShieldCheck,
  List
} from 'lucide-react';

// --- Constants & Config ---
const apiKey = ""; 
const TARIFF_ESCALATION = 0.065; 
const LIFESPAN_YEARS = 25;
const JHB_PEAK_SUN_HOURS = 5.2;
const P90_FACTOR = 0.91; // Standard reduction from P50 to P90 for high-confidence modeling

const SUPPLIERS = [
  { name: "SolarPrime SA", markup: 1.0 },
  { name: "GreenEnergy Solutions", markup: 1.05 },
  { name: "SunSponsors NGO", markup: 0.85 },
];

const MONTHS = [
  "January", "February", "March", "April", "May", "June", 
  "July", "August", "September", "October", "November", "December"
];

const SEASONAL_WEIGHTS = {
  0: 0.7, 1: 0.8, 2: 1.0, 3: 1.0, 4: 1.1, 5: 1.3, 
  6: 1.4, 7: 1.3, 8: 1.1, 9: 1.0, 10: 1.0, 11: 0.7
};

const SOLAR_CONFIGS = [
  {
    id: "config_65",
    title: "65kWp School Solution",
    inverterKw: 50,
    pvKwp: 65,
    bessKwh: 60,
    baseCost: 920000, 
    maintenanceAnnual: 12000,
    breakdown: {
      panels: 325000,
      inverters: 145000,
      batteries: 280000,
      bos: 170000
    }
  },
  {
    id: "config_150",
    title: "150kWp Enterprise Solution",
    inverterKw: 120,
    pvKwp: 150,
    bessKwh: 140,
    baseCost: 1950000,
    maintenanceAnnual: 28000,
    breakdown: {
      panels: 750000,
      inverters: 310000,
      batteries: 520000,
      bos: 370000
    }
  }
];

// --- Helper Components ---

const Card = ({ title, children, icon: Icon, className = "" }) => (
  <div className={`bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden ${className}`}>
    {title && (
      <div className="px-6 py-4 border-b border-slate-100 flex items-center gap-2 bg-slate-50/50">
        {Icon && <Icon className="w-5 h-5 text-blue-600" />}
        <h3 className="font-semibold text-slate-800">{title}</h3>
      </div>
    )}
    <div className="p-6">{children}</div>
  </div>
);

const Metric = ({ label, value, unit = "", subValue = "" }) => (
  <div className="p-4 bg-slate-50 rounded-lg border border-slate-100">
    <p className="text-xs font-medium text-slate-500 uppercase tracking-wider">{label}</p>
    <p className="text-2xl font-bold text-slate-900 mt-1">
      {unit}{value}
      {subValue && <span className="text-sm font-normal text-slate-500 ml-1">/ {subValue}</span>}
    </p>
  </div>
);

const Modal = ({ isOpen, onClose, title, children }) => {
  if (!isOpen) return null;
  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm">
      <div className="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div className="px-6 py-4 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10">
          <h3 className="text-xl font-bold text-slate-800">{title}</h3>
          <button onClick={onClose} className="p-2 hover:bg-slate-100 rounded-full transition-colors">
            <X size={20} />
          </button>
        </div>
        <div className="p-6">{children}</div>
      </div>
    </div>
  );
};

// --- Main Application ---

export default function App() {
  const [phase, setPhase] = useState(1);
  const [isScanning, setIsScanning] = useState(false);
  const [error, setError] = useState(null);
  const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());
  const [selectedSupplier, setSelectedSupplier] = useState(SUPPLIERS[0]);
  const [modalType, setModalType] = useState(null); 
  const [activeConfigId, setActiveConfigId] = useState(null);
  const fileInputRef = useRef(null);

  const [invoiceData, setInvoiceData] = useState({
    energyCostIncVat: 51750,
    serviceChargeIncVat: 2875,
    networkChargeIncVat: 9200,
    totalConsumption: 22000,
    vatRate: 0.15
  });

  const performAIExtraction = async (base64Data, mimeType) => {
    const prompt = `Extract South African utility bill data. Schools pay VAT as a cost. Keys: energyCostExVat, serviceChargeExVat, networkChargeExVat, totalConsumption, vatRate, billingMonth (0-11).`;
    const payload = {
      contents: [{ role: "user", parts: [{ text: prompt }, { inlineData: { mimeType, data: base64Data } }] }],
      generationConfig: { responseMimeType: "application/json" }
    };
    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });
    const result = await response.json();
    return JSON.parse(result.candidates?.[0]?.content?.parts?.[0]?.text);
  };

  const handleFileChange = async (e) => {
    const file = e.target.files[0];
    if (!file) return;
    setIsScanning(true);
    const reader = new FileReader();
    reader.onload = async () => {
      try {
        const data = await performAIExtraction(reader.result.split(',')[1], file.type);
        const vr = data.vatRate || 0.15;
        setInvoiceData({
          energyCostIncVat: (data.energyCostExVat || 0) * (1 + vr),
          serviceChargeIncVat: (data.serviceChargeExVat || 0) * (1 + vr),
          networkChargeIncVat: (data.networkChargeExVat || 0) * (1 + vr),
          totalConsumption: data.totalConsumption || 0,
          vatRate: vr
        });
        if (typeof data.billingMonth === 'number') setSelectedMonth(data.billingMonth);
        setIsScanning(false);
      } catch (err) {
        setError("AI Scan failed. Please check image quality.");
        setIsScanning(false);
      }
    };
    reader.readAsDataURL(file);
  };

  const totalInvoice = invoiceData.energyCostIncVat + invoiceData.serviceChargeIncVat + invoiceData.networkChargeIncVat;
  const effectiveCostPerKwh = totalInvoice / (invoiceData.totalConsumption || 1);

  const extrapolationData = useMemo(() => {
    const currentWeight = SEASONAL_WEIGHTS[selectedMonth];
    const totalWeights = Object.values(SEASONAL_WEIGHTS).reduce((a, b) => a + b, 0);
    const baseMonthLoad = invoiceData.totalConsumption / currentWeight;
    const annualKwh = baseMonthLoad * totalWeights;
    const annualCost = annualKwh * effectiveCostPerKwh;
    return { currentWeight, totalWeights, baseMonthLoad, annualKwh, annualCost };
  }, [invoiceData.totalConsumption, selectedMonth, effectiveCostPerKwh]);

  const solarAnalysis = useMemo(() => {
    return SOLAR_CONFIGS.map(config => {
      const systemCost = config.baseCost * selectedSupplier.markup;
      
      // APPLY P90 Yield Factor for conservative guarantee
      const annualYield = (config.pvKwp * JHB_PEAK_SUN_HOURS * 365 * 0.85) * P90_FACTOR; 
      const usableYield = Math.min(annualYield, extrapolationData.annualKwh * 0.98); 
      
      const year1Savings = usableYield * effectiveCostPerKwh;
      const r = 1 + TARIFF_ESCALATION;
      const total25YearSavings = year1Savings * (Math.pow(r, LIFESPAN_YEARS) - 1) / (r - 1);
      
      const totalLifeCosts = systemCost + (config.maintenanceAnnual * LIFESPAN_YEARS);
      const lcoe = totalLifeCosts / (annualYield * LIFESPAN_YEARS * 0.95);

      const consumptionOffset = (usableYield / extrapolationData.annualKwh) * 100;

      return {
        ...config,
        systemCost,
        annualYield,
        usableYield,
        lcoe,
        year1Savings,
        total25YearSavings,
        consumptionOffset,
        paybackYears: systemCost / (year1Savings || 1)
      };
    });
  }, [extrapolationData.annualKwh, effectiveCostPerKwh, selectedSupplier]);

  const bestOption = solarAnalysis.reduce((prev, curr) => (prev.paybackYears < curr.paybackYears ? prev : curr));
  const activeConfig = solarAnalysis.find(c => c.id === activeConfigId);

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-900">
      <header className="bg-white border-b border-slate-200 sticky top-0 z-10">
        <div className="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
              <Zap className="text-white w-5 h-5" fill="currentColor" />
            </div>
            <h1 className="font-bold text-xl tracking-tight text-slate-800">SchoolSolar<span className="text-blue-600">ROI</span></h1>
          </div>
          <nav className="hidden md:flex items-center gap-6">
            {['Audit', 'Solar Analysis', 'Get Quote'].map((step, i) => (
              <div key={step} className={`flex items-center gap-2 text-sm font-medium ${phase === i + 1 ? 'text-blue-600' : 'text-slate-400'}`}>
                <span className={`w-6 h-6 rounded-full border-2 flex items-center justify-center text-xs ${phase === i + 1 ? 'border-blue-600 bg-blue-50' : 'border-slate-200'}`}>
                  {i + 1}
                </span>
                {step}
              </div>
            ))}
          </nav>
        </div>
      </header>

      <main className="max-w-6xl mx-auto px-6 py-8">
        
        {phase === 1 && (
          <div className="space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div className="text-center max-w-2xl mx-auto">
              <h2 className="text-3xl font-bold text-slate-900 mb-4">Phase 1: Energy Baseline</h2>
              <p className="text-slate-600 italic text-sm">Validating your current grid spend including non-claimable VAT.</p>
            </div>

            <div className="grid md:grid-cols-2 gap-8">
              <Card title="Upload Invoice" icon={Upload}>
                <input type="file" ref={fileInputRef} onChange={handleFileChange} className="hidden" />
                <div 
                  className={`border-2 border-dashed rounded-xl p-10 flex flex-col items-center justify-center gap-4 cursor-pointer transition-all ${isScanning ? 'bg-blue-50 border-blue-400' : 'border-slate-200 hover:border-blue-500'}`}
                  onClick={() => !isScanning && fileInputRef.current.click()}
                >
                  {isScanning ? <Loader2 className="w-10 h-10 text-blue-600 animate-spin" /> : <Upload className="w-10 h-10 text-slate-400" />}
                  <p className="font-semibold">{isScanning ? "Extracting Data..." : "Drop Invoice Image"}</p>
                </div>
                <div className="mt-6 grid grid-cols-2 gap-4 pt-6 border-t border-slate-100">
                  <div className="col-span-2">
                    <label className="text-[10px] font-bold text-slate-400 uppercase">Monthly Consumption (kWh)</label>
                    <input type="number" value={invoiceData.totalConsumption} onChange={e => setInvoiceData({...invoiceData, totalConsumption: +e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                  </div>
                  <div>
                    <label className="text-[10px] font-bold text-slate-400 uppercase">Total Bill (Inc. VAT)</label>
                    <input type="number" value={Math.round(totalInvoice)} onChange={e => setInvoiceData({...invoiceData, energyCostIncVat: +e.target.value, serviceChargeIncVat: 0, networkChargeIncVat: 0})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                  </div>
                  <div className="flex items-center pt-4">
                     <span className="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded">R {effectiveCostPerKwh.toFixed(2)}/kWh</span>
                  </div>
                </div>
              </Card>

              <div className="space-y-6">
                <Card title="Audit Summary" icon={PieChart}>
                  <div className="space-y-4">
                    <Metric label="Monthly Cash Outflow" value={Math.round(totalInvoice).toLocaleString()} unit="R " />
                    <div className="p-4 bg-slate-900 text-white rounded-xl">
                       <p className="text-[10px] font-bold text-blue-400 uppercase mb-1">Effective Unit Benchmark</p>
                       <p className="text-3xl font-black font-mono">R {effectiveCostPerKwh.toFixed(2)}</p>
                       <p className="text-[10px] text-slate-400 mt-2">Any solar generation costing less than this represents a direct saving to school cash flow.</p>
                    </div>
                  </div>
                </Card>
                <button 
                  onClick={() => setPhase(2)}
                  className="w-full py-4 bg-blue-600 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-blue-700 transition-all"
                >
                  Compare Solar Solutions
                  <ChevronRight size={18} />
                </button>
              </div>
            </div>
          </div>
        )}

        {phase === 2 && (
          <div className="space-y-8 animate-in fade-in slide-in-from-right-4 duration-500">
            <div className="flex flex-col md:flex-row md:items-end justify-between gap-6">
              <div>
                <button onClick={() => setPhase(1)} className="text-blue-600 text-sm font-semibold mb-2 flex items-center gap-1 hover:underline">← Change Audit</button>
                <h2 className="text-3xl font-bold text-slate-900">Phase 2: Performance Modeling (P90)</h2>
              </div>
              <div className="flex gap-4">
                <select value={selectedMonth} onChange={e => setSelectedMonth(+e.target.value)} className="bg-white px-4 py-2 rounded-lg border border-slate-200 font-semibold text-sm">
                  {MONTHS.map((m, i) => <option key={m} value={i}>{m}</option>)}
                </select>
                <select value={selectedSupplier.name} onChange={e => setSelectedSupplier(SUPPLIERS.find(s => s.name === e.target.value))} className="bg-white px-4 py-2 rounded-lg border border-slate-200 font-semibold text-sm">
                  {SUPPLIERS.map(s => <option key={s.name} value={s.name}>{s.name}</option>)}
                </select>
              </div>
            </div>

            <div className="grid lg:grid-cols-4 gap-8">
              <div className="lg:col-span-1 space-y-6">
                <Card title="Annual Forecast" icon={Calendar}>
                  <div className="space-y-4">
                    <Metric label="Est. Load" value={Math.round(extrapolationData.annualKwh).toLocaleString()} unit="" subValue="kWh/yr" />
                    <button onClick={() => setModalType('extrapolation')} className="w-full py-2 bg-slate-100 text-slate-600 rounded-lg text-xs font-bold hover:bg-slate-200 flex items-center justify-center gap-2">View Weights <Info size={14} /></button>
                  </div>
                </Card>

                <div className="bg-slate-900 text-white p-6 rounded-2xl shadow-xl">
                  <div className="flex items-center gap-2 mb-3">
                    <ShieldCheck className="text-green-400" size={20} />
                    <h4 className="font-bold">P90 Guarantee</h4>
                  </div>
                  <p className="text-[10px] text-slate-400 leading-relaxed italic">
                    We utilize a P90 probability model (standard reduction of ~9%). This guarantees that in 9 out of 10 years, your actual generation will EXCEED these estimates.
                  </p>
                </div>
              </div>

              <div className="lg:col-span-3 grid md:grid-cols-2 gap-6">
                {solarAnalysis.map((res) => (
                  <div key={res.id} className={`bg-white rounded-3xl border-2 p-8 transition-all ${bestOption.id === res.id ? 'border-blue-600 ring-8 ring-blue-50' : 'border-slate-100'}`}>
                    <div className="mb-6 flex justify-between items-start">
                      <div>
                        <h4 className="text-xl font-bold text-slate-800">{res.title}</h4>
                        <p className="text-xs text-slate-400 mt-1">{res.pvKwp}kWp PV | {res.bessKwh}kWh BESS</p>
                      </div>
                      <div className="bg-blue-50 text-blue-600 p-2 rounded-full">
                        <Zap size={20} />
                      </div>
                    </div>

                    <div className="space-y-6">
                      <div className="p-4 bg-slate-50 rounded-2xl">
                        <div className="flex justify-between items-center mb-2">
                           <span className="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Annual Demand Offset</span>
                           <span className="text-sm font-black text-blue-600">{res.consumptionOffset.toFixed(1)}%</span>
                        </div>
                        <div className="w-full bg-slate-200 h-2 rounded-full overflow-hidden">
                           <div className="bg-blue-600 h-full rounded-full" style={{ width: `${Math.min(res.consumptionOffset, 100)}%` }}></div>
                        </div>
                      </div>

                      <div className="flex justify-between items-end">
                        <div className="flex flex-col">
                          <span className="text-[10px] text-slate-400 font-bold uppercase mb-1">Total System Cost</span>
                          <span className="text-2xl font-black text-slate-800">R {Math.round(res.systemCost).toLocaleString()}</span>
                          <button 
                            onClick={() => { setActiveConfigId(res.id); setModalType('costBreakdown'); }}
                            className="text-[10px] text-blue-600 font-bold flex items-center gap-1 hover:underline mt-1"
                          >
                            <List size={10} /> View Breakdown
                          </button>
                        </div>
                        <div className="text-right">
                          <span className="text-[10px] text-slate-400 font-bold uppercase mb-1">Payback</span>
                          <p className="text-lg font-bold text-slate-800">{res.paybackYears.toFixed(1)} <span className="text-sm font-normal">Yrs</span></p>
                        </div>
                      </div>

                      <div className="bg-blue-600 p-6 rounded-2xl text-white">
                        <p className="text-xs font-bold text-blue-200 uppercase mb-1">25-Year Saving Opportunity</p>
                        <p className="text-3xl font-black">R {Math.round(res.total25YearSavings / 1000000).toFixed(1)} Million</p>
                      </div>

                      <button onClick={() => setPhase(3)} className="w-full py-4 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 transition-all">Request Official Quote</button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}

        {phase === 3 && (
          <div className="max-w-4xl mx-auto py-10 animate-in zoom-in-95 duration-500">
             <div className="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200">
                <div className="bg-slate-900 p-10 text-white">
                  <h2 className="text-3xl font-bold mb-2">Finalize Your School Audit</h2>
                  <p className="text-slate-400 max-w-md">Our JHB energy specialists will perform a physical site audit to verify these P90 projections.</p>
                </div>
                <div className="p-10 grid md:grid-cols-2 gap-10">
                  <div className="space-y-6">
                    <input type="text" placeholder="School Name" className="w-full px-4 py-3 bg-slate-50 rounded-xl border border-slate-200 outline-none" />
                    <input type="email" placeholder="Email Address" className="w-full px-4 py-3 bg-slate-50 rounded-xl border border-slate-200 outline-none" />
                    <input type="tel" placeholder="Phone Number" className="w-full px-4 py-3 bg-slate-50 rounded-xl border border-slate-200 outline-none" />
                    <button className="w-full py-4 bg-blue-600 text-white font-bold rounded-2xl">Submit Quote Request</button>
                  </div>
                  <div className="bg-slate-50 p-8 rounded-3xl space-y-4">
                    <h4 className="font-bold text-lg text-slate-800">Your Chosen System</h4>
                    <div className="space-y-2 text-sm">
                      <div className="flex justify-between"><span>Cost:</span><span className="font-bold">R {Math.round(bestOption.systemCost).toLocaleString()}</span></div>
                      <div className="flex justify-between"><span>Offset:</span><span className="font-bold text-blue-600">{bestOption.consumptionOffset.toFixed(1)}%</span></div>
                      <div className="flex justify-between"><span>25yr Savings:</span><span className="font-bold text-green-600">R {Math.round(bestOption.total25YearSavings).toLocaleString()}</span></div>
                    </div>
                  </div>
                </div>
             </div>
          </div>
        )}
      </main>

      {/* MODALS */}
      <Modal isOpen={modalType === 'extrapolation'} onClose={() => setModalType(null)} title="Annual Consumption Calculation">
        <div className="space-y-6">
          <p className="text-sm text-slate-600 leading-relaxed">Extrapolated using SA school seasonal weights.</p>
          <div className="bg-slate-50 p-6 rounded-xl space-y-4">
            <div className="flex justify-between"><span>Invoiced Month:</span><span className="font-bold">{invoiceData.totalConsumption.toLocaleString()} kWh</span></div>
            <div className="flex justify-between"><span>Weight:</span><span className="font-bold text-blue-600">{extrapolationData.currentWeight.toFixed(2)}</span></div>
            <div className="flex justify-between pt-4 border-t font-bold"><span>Annual Total:</span><span className="text-xl text-blue-600">{Math.round(extrapolationData.annualKwh).toLocaleString()} kWh</span></div>
          </div>
        </div>
      </Modal>

      <Modal isOpen={modalType === 'costBreakdown'} onClose={() => {setModalType(null); setActiveConfigId(null);}} title={`${activeConfig?.title} - Cost Model`}>
        {activeConfig && (
          <div className="space-y-6">
            <div className="grid grid-cols-2 gap-4">
              <div className="p-4 bg-blue-50 rounded-xl border border-blue-100">
                <p className="text-[10px] text-blue-600 font-bold uppercase mb-1">Total System Capex</p>
                <p className="text-2xl font-black text-blue-800">R {Math.round(activeConfig.systemCost).toLocaleString()}</p>
              </div>
              <div className="p-4 bg-slate-50 rounded-xl border border-slate-100">
                <p className="text-[10px] text-slate-500 font-bold uppercase mb-1">Annual Yield (P90)</p>
                <p className="text-2xl font-black text-slate-800">{Math.round(activeConfig.annualYield).toLocaleString()} kWh</p>
              </div>
            </div>
            
            <div className="space-y-4">
              <h4 className="font-bold text-slate-800 border-b pb-2">Investment Breakdown</h4>
              <div className="space-y-3">
                {[
                  { label: "Tier 1 PV Panels", value: activeConfig.breakdown.panels },
                  { label: "Hybrid Inverter(s)", value: activeConfig.breakdown.inverters },
                  { label: "Battery Energy Storage (BESS)", value: activeConfig.breakdown.batteries },
                  { label: "Install, Wiring & Commissioning", value: activeConfig.breakdown.bos }
                ].map((item, idx) => (
                  <div key={idx} className="flex justify-between items-center text-sm py-1">
                    <span className="text-slate-600">{item.label}</span>
                    <span className="font-mono font-bold">R {item.value.toLocaleString()}</span>
                  </div>
                ))}
              </div>
            </div>
            <p className="text-[10px] text-slate-400 italic mt-4 text-center">Note: Figures represent estimated pricing including VAT and logistics within JHB.</p>
          </div>
        )}
      </Modal>

      <Modal isOpen={modalType === 'savings'} onClose={() => setModalType(null)} title="25-Year Geometric Projections">
        <div className="space-y-4">
          <p className="text-sm text-slate-600">Projections based on 6.5% annual tariff escalation.</p>
          <div className="overflow-x-auto">
             <table className="w-full text-left text-sm">
                <thead className="text-[10px] uppercase font-bold text-slate-400">
                  <tr className="border-b">
                    <th className="py-2">Period</th>
                    <th className="py-2">Est. Tariff</th>
                    <th className="py-2">Cumulative Savings</th>
                  </tr>
                </thead>
                <tbody className="font-mono">
                  {[1, 5, 10, 25].map(y => {
                    const tariff = effectiveCostPerKwh * Math.pow(1.065, y-1);
                    const cumSaving = bestOption.year1Savings * (Math.pow(1.065, y) - 1) / 0.065;
                    return (
                      <tr key={y} className="border-b border-slate-50">
                        <td className="py-2">Year {y}</td>
                        <td className="py-2">R {tariff.toFixed(2)}</td>
                        <td className="py-2 text-green-600">R {Math.round(cumSaving).toLocaleString()}</td>
                      </tr>
                    );
                  })}
                </tbody>
             </table>
          </div>
        </div>
      </Modal>

      <footer className="py-10 border-t border-slate-200 bg-white">
        <div className="max-w-6xl mx-auto px-6 text-center text-slate-400 text-[10px]">
          © 2025 SolarForSchools JHB. Calculations use P90 confidence intervals for risk mitigation.
        </div>
      </footer>
    </div>
  );
}